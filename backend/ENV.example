# ===========================================
# Configuration Backend - Tshiakani VTC
# ===========================================
# Copiez ce fichier vers .env et remplissez les valeurs

# Environnement
NODE_ENV=production
PORT=3000

# ===========================================
# Base de données PostgreSQL
# ===========================================
# Option 1: URL de connexion complète (recommandé pour GCP Cloud SQL)
DATABASE_URL=postgresql://username:password@host:5432/database_name

# Option 2: Variables individuelles (pour compatibilité)
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_password_here
DB_NAME=tshiakani_vtc

# Connection Pooling (optionnel)
DB_POOL_MAX=20
DB_POOL_CONNECTION_TIMEOUT=2000
DB_POOL_IDLE_TIMEOUT=30000
DB_STATEMENT_TIMEOUT=30000

# ===========================================
# Sécurité
# ===========================================
# JWT Secret - Générer une clé forte (min 64 caractères)
# Utiliser: openssl rand -hex 32
JWT_SECRET=your_jwt_secret_here_min_64_characters_long

# Clé API Admin pour les routes protégées
ADMIN_API_KEY=your_admin_api_key_here

# ===========================================
# CORS
# ===========================================
# URLs autorisées (séparées par des virgules)
CORS_ORIGIN=https://tshiakani-vtc.firebaseapp.com,https://tshiakani-vtc.web.app

# ===========================================
# Rate Limiting
# ===========================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ===========================================
# Firebase Admin SDK (pour les notifications push)
# ===========================================
# Option 1: Fichier de service account (recommandé)
FIREBASE_SERVICE_ACCOUNT_PATH=./config/firebase-service-account.json

# Option 2: Variables d'environnement (alternative)
FIREBASE_PROJECT_ID=tshiakani-vtc
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@tshiakani-vtc.iam.gserviceaccount.com
FIREBASE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n

# ===========================================
# Google Cloud Storage (pour le stockage de fichiers)
# ===========================================
# ID du projet GCP
GCP_PROJECT_ID=tshiakani-vtc
GOOGLE_CLOUD_PROJECT=tshiakani-vtc

# Nom du bucket Cloud Storage
GCS_BUCKET_NAME=tshiakani-vtc-documents

# Chemin vers le fichier de credentials (développement local uniquement)
# En production sur Cloud Run, les credentials sont automatiques
GOOGLE_APPLICATION_CREDENTIALS=./config/gcp-service-account.json

# ===========================================
# Stripe (paiements)
# ===========================================
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# ===========================================
# Google Maps API
# ===========================================
GOOGLE_MAPS_API_KEY=your_google_maps_api_key_here

# ===========================================
# WebSocket
# ===========================================
WS_CORS_ORIGIN=https://tshiakani-vtc.firebaseapp.com,https://tshiakani-vtc.web.app

# ===========================================
# Cloud SQL (pour Cloud Run)
# ===========================================
# Nom de connexion de l'instance Cloud SQL
INSTANCE_CONNECTION_NAME=tshiakani-vtc:us-central1:tshiakani-vtc-db

# ===========================================
# Twilio (pour l'envoi de codes OTP via WhatsApp/SMS)
# ===========================================
# Account SID - Trouvé dans Twilio Console > Account > Account Info
TWILIO_ACCOUNT_SID=your_account_sid_here

# Auth Token - Trouvé dans Twilio Console > Account > Account Info
TWILIO_AUTH_TOKEN=your_auth_token_here

# Numéro WhatsApp Twilio (Sandbox pour les tests: whatsapp:+14155238886)
# Pour la production, utilisez votre numéro WhatsApp Business approuvé
TWILIO_WHATSAPP_FROM=whatsapp:+14155238886

# Numéro SMS Twilio (optionnel, pour fallback si WhatsApp échoue)
TWILIO_PHONE_NUMBER=+1234567890

# Content SID du template WhatsApp pour les codes OTP
# Créer un template dans Twilio Console → Content → Templates
TWILIO_CONTENT_SID=HX229f5a04fd0510ce1b071852155d3e75

# ===========================================
# Redis (Upstash Redis - GRATUIT ou Redis Local/Memorystore)
# ===========================================
# Option 1: Upstash Redis (RECOMMANDÉ - GRATUIT, 10k commandes/jour)
# Créer un compte sur https://upstash.com/ et récupérer l'URL de connexion
REDIS_URL=redis://default:your_token@endpoint.upstash.io:6379

# Option 2: Redis Local ou Memorystore (alternative)
# Décommentez ces variables si vous utilisez Redis local ou Memorystore
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=

# Timeout de connexion (millisecondes)
REDIS_CONNECT_TIMEOUT=10000

# Note: Si REDIS_URL est défini, il sera utilisé en priorité (Upstash Redis)
# Sinon, REDIS_HOST sera utilisé (Redis local ou Memorystore)
